<%= simple_form_for([day, day_recipe]) do |f| %>
  <div class="grid grid-cols-1 gap-4">
    <%= f.association :recipe,
        collection: Recipe.where(user: current_user),
        prompt: "Sélectionnez une recette",
        disabled: !day_recipe.new_record?,
        input_html: {
          class: "w-full rounded border border-gray-300 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition appearance-none pr-10",
          style: "background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"%23374151\" stroke-width=\"2\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19 9l-7 7-7-7\"/></svg>'); background-position: right 12px center; background-size: 20px 20px; background-repeat: no-repeat;"
        },
        label_html: { class: "font-medium text-gray-700" } %>

    <% if @day_food_groups.any? %>
      <%= f.association :day_food_group,
          collection: @day_food_groups,
          prompt: "Sélectionnez un groupe",
          input_html: {
            class: "w-full rounded border border-gray-300 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition appearance-none pr-10",
            style: "background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"%23374151\" stroke-width=\"2\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19 9l-7 7-7-7\"/></svg>'); background-position: right 12px center; background-size: 20px 20px; background-repeat: no-repeat;"
          },
          label_html: { class: "font-medium text-gray-700" },
          label: "Groupe de repas" %>
    <% else %>
      <div class="form-group">
        <label class="font-medium text-gray-700 block mb-3">Groupe de repas</label>
        <div class="text-center py-6 px-4 border border-gray-200 rounded-lg bg-gray-50">
          <div class="w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center">
            <i class="fas fa-utensils text-gray-400"></i>
          </div>
          <h3 class="text-sm font-medium text-gray-900 mb-1">Aucun groupe de repas</h3>
          <p class="text-gray-500 text-xs mb-3">Créez des groupes de repas dans les paramètres</p>
        </div>
      </div>
    <% end %>

    <%= f.input :quantity,
        as: :numeric,
        min: 0.1,
        input_html: {
          class: "w-full rounded border border-gray-300 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition",
          value: day_recipe.new_record? ? 100 : day_recipe.quantity
        },
        label_html: { class: "font-medium text-gray-700" },
        append: "g" %>

    <%= f.input :use_recipe_quantity,
        as: :boolean,
        input_html: { class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" },
        label_html: { class: "font-medium text-gray-700" },
        label: "Utiliser la quantité totale de la recette" %>
  </div>

  <div class="flex justify-center gap-4 mt-8">
    <%= link_to "Annuler", calendars_path, class: "px-6 py-2 bg-gray-200 text-gray-800 rounded-lg shadow hover:bg-gray-300 transition font-semibold text-center text-sm" %>
    <%= f.button :submit, submit_text, class: "px-6 py-2 bg-blue-800 text-white rounded-lg shadow hover:bg-blue-600 transition font-semibold text-center text-sm" %>
  </div>
<% end %>
